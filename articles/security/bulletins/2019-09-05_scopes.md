---
title: Auth0 Security Bulletin for Assigning Scopes Based on Email Address
description: Cases where improper custom rule code may create vulnerabilities in the authentication flow.
topics:
  - security
  - security-bulletins
  - rules
contentType:
  - reference
useCase:
  - development
---

# Auth0 Security Bulletin for Assigning Scopes Based on Email Address

## Overview

If you use rules to assign scopes to users based on their email address there is a possibility that scopes could be compromised if your application uses multiple connections.

Auth0 requires that email addresses are unique per connection, but not per application (client). Therefore, if you are using rules to assign scopes based on email address, and if a legitimate user A (`user_a@domain.com`) signs up via one connection, and a malicious user B signs up on a different connection using legitimate user A's email address, then malicious user B will get the same scopes as legitimate user A. This would result in two distinct users with the same email address and same scopes.

## Am I affected?

You are vulnerable if:

* You are using rules to assign scopes to users based on email address **and**
* You are using multiple connections per application

## How do I fix this?

The most straightforward mitigation is to require users to [verify their email address](/api/management/v2#!/Jobs/post_verification_email) after signing up and before being allowed to log in.
