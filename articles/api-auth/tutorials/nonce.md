---
description: How to securely generate and validate a cryptographic nonce for use with the Implicit Grant
topics:
  - api-authentication
  - oidc
  - implicit
  - nonce
contentType: tutorial
useCase:
  - secure-api
  - call-api
---

# Mitigate replay attacks when using the Implicit Flow

<%= include('../../_includes/_pipeline2') %>

To mitigate replay attacks when using the [Implicit Flow](/flows/concepts/implicit), a [cryptographic nonce](https://en.wikipedia.org/wiki/Cryptographic_nonce) must be sent on authentication requests [as required by the OpenID Connect specification](https://openid.net/specs/openid-connect-core-1_0.html#ImplicitAuthRequest).

The nonce is generated by the application, sent as a `nonce` query string parameter in the authentication request, and included in the ID Token response from Auth0. This allows applications to correlate the ID Token response from Auth0 with the initial authentication request.

For more information on where to include the nonce, see [Call API Using the Implicit Flow](/flows/guides/implicit/call-api-implicit).

## Generate a cryptographically random nonce

One way to generate a cryptographically random nonce is to use a tool like [Nano ID](https://github.com/ai/nanoid) or similar. This does require you to bundle the tool with your JavaScript code, however. If that's not possible, you can take advantage of the fact that [modern browsers](http://caniuse.com/#feat=cryptography) can use the [Web Crypto API](https://www.w3.org/TR/WebCryptoAPI/) to generate cryptographically secure random strings for use as nonces.

```js
function randomString(length) {
    var charset = '0123456789ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvwxyz-._~'
    result = ''

    while (length > 0) {
        var bytes = new Uint8Array(16);
        var random = window.crypto.getRandomValues(bytes);

        random.forEach(function(c) {
            if (length == 0) {
                return;
            }
            if (c < charset.length) {
                result += charset[c];
                length--;
            }
        });
    }
    return result;
}
```

## Persist nonces across requests

The generated nonce must be persisted in your web application using any of the following methods:

* `HttpOnly` session cookie
* HTML5 local storage value

For example:

```js
window.localStorage.setItem('nonce', randomString(16));
```

## Validate the ID Token

Once Auth0 responds with an ID Token, this token must be validated and decoded as usual.
Its `nonce` claim must contain the exact same value that was sent in the request.
If not, authentication should be rejected by the application.

```js
var jwt = '...'; // validated and decoded ID Token body
if (jwt.nonce === window.localStorage.getItem('nonce')) {
    // Nonce is OK
} else {
    // Nonce is not OK! Token replay attack might be underway
}
```
