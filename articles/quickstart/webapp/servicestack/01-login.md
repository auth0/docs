---
title: Login
default: true
description: This tutorial demonstrates how to add user login to a ServiceStack web application.
budicon: 448
github:
    path: 00-Starter-Seed
---

<%= include('../_includes/_getting_started', { library: 'ServiceStack', callback: 'http://localhost:<port>/api/auth/auth0' }) %>

### Create a ServiceStack application

For this example, we will use the standard template that ships with Visual Studio. Select __"FILE > New project > ASP.NET Web Application > MVC"__ .

Once the default template unfolds, use NuGet to install the **ServiceStack.Host.Mvc** nuget, running the command:

${snippet(meta.snippets.dependencies)}

![](/media/articles/server-platforms/servicestack/install-servicestack-nuget.png)

Change `HomeController` to return the `default.htm` page. Under the __Controllers__ folder add:

```cs
public class HomeController : Controller
{
    public ActionResult Index()
    {
        return Redirect("default.htm");
    }
}
```

## Configure ServiceStack to use Auth0 

We provide a [Nuget package](http://nuget.org/packages/Auth0-ServiceStack-OAuthProvider/) to simplify integration of Auth0 with ServiceStack based applications.

Run this command on the __Package Manager Console__:

```text
Install-Package Auth0-ServiceStack-OAuthProvider
```

This command will add two classes to your project under the __App_Start__ folder: `Auth0Provider` and `Auth0UserSession`.

`Auth0Provider` extends ServiceStack's `OAuthProvider` and handles the authentication transaction for you.

### Enable Authentication and Plugin Auth0's Provider

Open the `AppHost.cs` file (also under the __App_Start__ folder) generated by the ServiceStack NuGet. Uncomment the following call under the `Configure` method:

```text
ConfigureAuth(container);
```

And then uncomment (if it is commented out) and edit the `ConfigureAuth` method to look like this:

${snippet(meta.snippets.setup)}

::: note
In this sample we are not interested in user registration. So we are leaving that section out.
:::

### Enter Configuration Settings

Open your `web.config` file and change the three Auth0's parameters under `<appSettings>`:

```text
<add key="oauth.auth0.AppId" value="${account.clientId}" />
<add key="oauth.auth0.AppSecret" value="YOUR_CLIENT_SECRET" />
<add key="oauth.auth0.OAuthServerUrl" value="https://${account.namespace}" />
```

### Add Backend Code to Test the App

Open the `WebServiceExamples.cs` file.

Add the `Authenticate` Attribute to the `Hello` DTO:

```cs
[Authenticate]
public class Hello
{
  public string Name { get; set; }
}
```

Add an `IAuthSession` Property to the `HelloResponse` DTO:

```cs
public class HelloResponse
{
  public IAuthSession UserInfo { get; set; }
  public string Result { get; set; }
  public ResponseStatus ResponseStatus { get; set; } //Where Exceptions get auto-serialized
}
```

Modify the `HelloService` to Return the Current User's `UserInfo` Object

```cs
public class HelloService : Service
{
  public object Any(Hello request)
  {
    IAuthSession session = this.GetSession();
    var sb = new StringBuilder();
    sb.AppendLine("Id: " + session.Id);
    sb.AppendLine("DisplayName: " + session.DisplayName);

    return new HelloResponse { Result = "Hello, " + request.Name, UserInfo = session };
  }
}
```

::: note
Notice we are not doing anything useful with these properties. You can place a breakpoint here and explore the session object.
:::

## Trigger Authentication

You will need to redirect the user to the Auth0 Authorization endpoint in order to log in to the application. We will use the [Auth0.NET SDK](https://github.com/auth0/auth0.net) to construct the redirect URL. First, install the `Auth0.AuthenticationApi` NuGet package:

```text
Install-Package Auth0.AuthenticationApi
```

Then, add an `AccountController` class to your MVC application with a `Login` action. This action will construct the authorization URL, and then redirect the user to that URL.

```cs
public class AccountController : Controller
{
    public ActionResult Login()
    {
        string clientId = WebConfigurationManager.AppSettings["oauth.auth0.AppId"];
        string domain = WebConfigurationManager.AppSettings["oauth.auth0.OAuthServerUrl"].Substring(8);

        var redirectUri = new UriBuilder(this.Request.Url.Scheme, this.Request.Url.Host, this.Request.Url.IsDefaultPort ? -1 : this.Request.Url.Port, "api/auth/auth0");

        var client = new AuthenticationApiClient(new Uri($"https://{domain}"));
        var authorizeUrlBuilder = client.BuildAuthorizationUrl()
            .WithClient(clientId)
            .WithRedirectUrl(redirectUri.ToString())
            .WithResponseType(AuthorizationResponseType.Code)
            .WithScope("openid profile")
            .WithAudience($"https://{domain}/userinfo");


        return Redirect(authorizeUrlBuilder.Build().ToString());
    }
}
```

## Display User Information

Open `default.htm` and add a login button which will redirect the user to the `/Account/Login` route:

```html
<div>
    <a class="btn" href="/Account/Login">Log In</a>
</div>
```

Also add the following statement in the `jQuery.ready` body which will call the `/api/hello` endpoint which will return the logged in user's information:

```js
// get user info from hello endpoint
$.getJSON('/api/hello', function (data) {
    $('#userInfo').text(JSON.stringify(data.userInfo, 1, 2));
});
```

Add a section to display the `UserInfo`:

```html
<div>User Info:
     <pre><code id="userInfo">Not logged in</code></pre>
</div>
```
